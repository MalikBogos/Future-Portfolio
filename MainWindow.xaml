<Window x:Class="FuturePortfolio.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Excel-like Application" Height="450" Width="800">
    <Grid>
        <DataGrid x:Name="ExcelLikeGrid"
                  AutoGenerateColumns="False"
                  CanUserSortColumns="True"
                  EnableColumnVirtualization="True"
                  EnableRowVirtualization="True"
                  CellEditEnding="ExcelLikeGrid_CellEditEnding"
                  HorizontalScrollBarVisibility="Auto"
                  VerticalScrollBarVisibility="Auto"
                  HorizontalAlignment="Left"
                  VerticalAlignment="Top"
                  HeadersVisibility="All"
                  RowHeaderWidth="25">
            <DataGrid.RowHeaderTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=Header}"
                               VerticalAlignment="Center"
                               HorizontalAlignment="Center"/>
                </DataTemplate>
            </DataGrid.RowHeaderTemplate>
            <DataGrid.Columns>
                <DataGridTextColumn Header="A" Binding="{Binding [0].Value}" Width="100"/>
                <DataGridTextColumn Header="B" Binding="{Binding [1].Value}" Width="100"/>
                <DataGridTextColumn Header="C" Binding="{Binding [2].Value}" Width="100"/>
            </DataGrid.Columns>
            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="DataGridCell">
                                <Border BorderThickness="0,0,1,1" BorderBrush="LightGray">
                                    <TextBlock Text="{Binding Value}" 
                                               FontStyle="{Binding Format.FontStyle}"
                                               FontWeight="{Binding Format.FontWeight}"
                                               Foreground="{Binding Format.ForegroundColor}"
                                               Background="{Binding Format.BackgroundColor}"
                                               Padding="5,2"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DataGrid.CellStyle>
        </DataGrid>
    </Grid>
</Window>